<div class="container-fluid px-0" data-ng-if="$ctrl.isEditMode">
    <div class="row">
        <oui-select-picker
            class="d-inline-block col-md-6 col-xl-4 my-3"
            data-ng-repeat="schedule in ::$ctrl.WORKFLOW_SCHEDULES"
            data-name="{{ ::schedule.name }}"
            data-description="{{ ::'pci_workflow_create_schedule_' + schedule.description + '_description' | translate: { numEntries: schedule.rotation } }}"
            data-model="$ctrl.schedule"
            data-label="{{ ::'pci_workflow_create_schedule_' + schedule.name + '_title' | translate }}"
            data-values="[schedule]"
            data-variant="light"
            data-required
        >
        </oui-select-picker>
    </div>
    <div data-ng-if="$ctrl.schedule && $ctrl.schedule.name === 'custom'">
        <span
            data-translate="pci_workflow_create_cron_title"
            class="font-weight-bold d-inline-block pr-1"
        ></span>
        (<span
            class="pr-1"
            data-translate="pci_workflow_create_cron_timezone"
        ></span
        >)
        <button
            type="button"
            class="oui-popover-button"
            data-oui-popover
            data-oui-popover-open="$ctrl.help.openCronHelp"
            data-oui-popover-on-close="$ctrl.help.openCronHelp = false"
            data-ng-click="$ctrl.openHelp('cron')"
            data-oui-popover-scope="$ctrl"
            data-oui-popover-template="cron-help.html"
        ></button>
        <section class="cron-form d-flex">
            <div
                class="oui-field pr-3"
                data-ng-class="{ 'oui-field_error': $ctrl.minutesInvalid }"
            >
                <label
                    for="cron-minutes"
                    class="sr-only oui-field__label oui-label"
                    data-translate="pci_workflow_create_cron_minutes"
                ></label>
                <div class="oui-field__control oui-field__control_xs">
                    <input
                        class="oui-input"
                        data-ng-class="{ 'oui-field_error': $ctrl.minutesInvalid }"
                        type="text"
                        id="cron-minutes"
                        name="cron-minutes"
                        required
                        data-ng-model="$ctrl.schedule.cronPattern.minutes"
                        data-ng-blur="$ctrl.validateMinutes()"
                    />
                </div>
                <div
                    class="oui-field__error pr-2"
                    data-ng-if="$ctrl.minutesInvalid"
                >
                    <span role="alert">
                        <span
                            class="oui-icon oui-icon-error"
                            aria-hidden="true"
                        ></span>
                        <span
                            data-translate="pci_workflow_create_cron_invalid"
                        ></span>
                    </span>
                </div>
                <div
                    class="oui-field__helper"
                    data-translate="pci_workflow_create_cron_minutes"
                ></div>
            </div>
            <div
                class="oui-field pr-3"
                data-ng-class="{ 'oui-field_error': $ctrl.hoursInvalid }"
            >
                <label
                    for="cron-hours"
                    class="sr-only oui-field__label oui-label"
                    data-translate="pci_workflow_create_cron_hour"
                ></label>
                <div class="oui-field__control oui-field__control_xs">
                    <input
                        class="oui-input"
                        data-ng-class="{ 'oui-field_error': $ctrl.hoursInvalid }"
                        type="text"
                        id="cron-hours"
                        name="cron-hours"
                        required
                        data-ng-model="$ctrl.schedule.cronPattern.hour"
                        data-ng-blur="$ctrl.validateHour()"
                    />
                </div>
                <div
                    class="oui-field__error pr-2"
                    data-ng-if="$ctrl.hoursInvalid"
                >
                    <span role="alert">
                        <span
                            class="oui-icon oui-icon-error"
                            aria-hidden="true"
                        ></span>
                        <span
                            data-translate="pci_workflow_create_cron_invalid"
                        ></span>
                    </span>
                </div>
                <div
                    class="oui-field__helper"
                    data-translate="pci_workflow_create_cron_hour"
                ></div>
            </div>
            <div
                class="oui-field pr-3"
                data-ng-class="{ 'oui-field_error': $ctrl.domInvalid }"
            >
                <label
                    for="cron-dom"
                    class="sr-only oui-field__label oui-label"
                    data-translate="pci_workflow_create_cron_dom"
                ></label>
                <div class="oui-field__control oui-field__control_xs">
                    <input
                        class="oui-input"
                        data-ng-class="{ 'oui-field_error': $ctrl.domInvalid }"
                        type="text"
                        id="cron-dom"
                        name="cron-dom"
                        required
                        data-ng-model="$ctrl.schedule.cronPattern.dom"
                        data-ng-blur="$ctrl.validateDom()"
                    />
                </div>
                <div
                    class="oui-field__error pr-2"
                    data-ng-if="$ctrl.domInvalid"
                >
                    <span role="alert">
                        <span
                            class="oui-icon oui-icon-error"
                            aria-hidden="true"
                        ></span>
                        <span
                            data-translate="pci_workflow_create_cron_invalid"
                        ></span>
                    </span>
                </div>
                <div
                    class="oui-field__helper"
                    data-translate="pci_workflow_create_cron_dom"
                ></div>
            </div>
            <div
                class="oui-field pr-3"
                data-ng-class="{ 'oui-field_error': $ctrl.monthInvalid }"
            >
                <label
                    for="cron-month"
                    class="sr-only oui-field__label oui-label"
                    data-translate="pci_workflow_create_cron_month"
                ></label>
                <div class="oui-field__control oui-field__control_xs">
                    <input
                        class="oui-input"
                        data-ng-class="{ 'oui-field_error': $ctrl.monthInvalid }"
                        type="text"
                        id="cron-month"
                        name="cron-month"
                        required
                        data-ng-model="$ctrl.schedule.cronPattern.month"
                        data-ng-blur="$ctrl.validateMonth()"
                    />
                </div>
                <div
                    class="oui-field__error pr-2"
                    data-ng-if="$ctrl.monthInvalid"
                >
                    <span role="alert">
                        <span
                            class="oui-icon oui-icon-error"
                            aria-hidden="true"
                        ></span>
                        <span
                            data-translate="pci_workflow_create_cron_invalid"
                        ></span>
                    </span>
                </div>
                <div class="oui-field__helper">
                    <span
                        data-translate="pci_workflow_create_cron_month"
                    ></span>
                    <button
                        type="button"
                        class="oui-popover-button"
                        data-oui-popover
                        data-oui-popover-scope="$ctrl"
                        data-oui-popover-placement="bottom"
                        data-oui-popover-open="$ctrl.help.openMonthHelp"
                        data-oui-popover-on-close="$ctrl.help.openMonthHelp = false"
                        data-ng-click="$ctrl.openHelp('month')"
                        data-oui-popover-template="cron-month-help.html"
                    ></button>
                </div>
            </div>
            <div
                class="oui-field pr-3"
                data-ng-class="{ 'oui-field_error': $ctrl.dowInvalid }"
            >
                <label
                    for="cron-dow"
                    class="sr-only oui-field__label oui-label"
                    data-translate="pci_workflow_create_cron_dow"
                ></label>
                <div class="oui-field__control oui-field__control_xs">
                    <input
                        class="oui-input"
                        data-ng-class="{ 'oui-field_error': $ctrl.dowInvalid }"
                        type="text"
                        id="cron-dow"
                        name="cron-dow"
                        required
                        data-ng-model="$ctrl.schedule.cronPattern.dow"
                        data-ng-blur="$ctrl.validateDow()"
                    />
                </div>
                <div
                    class="oui-field__error pr-2"
                    data-ng-if="$ctrl.dowInvalid"
                >
                    <span role="alert">
                        <span
                            class="oui-icon oui-icon-error"
                            aria-hidden="true"
                        ></span>
                        <span
                            data-translate="pci_workflow_create_cron_invalid"
                        ></span>
                    </span>
                </div>
                <div class="oui-field__helper">
                    <span data-translate="pci_workflow_create_cron_dow"></span>
                    <button
                        type="button"
                        class="oui-popover-button"
                        data-oui-popover
                        data-oui-popover-scope="$ctrl"
                        data-oui-popover-open="$ctrl.help.openDowHelp"
                        data-oui-popover-on-close="$ctrl.help.openDowHelp = false"
                        data-ng-click="$ctrl.openHelp('dow')"
                        data-oui-popover-template="cron-dow-help.html"
                    ></button>
                </div>
            </div>
        </section>
        <section>
            <oui-field
                data-label="{{ ::'pci_workflow_create_rotate' | translate}}"
                data-help-text="{{ ::'pci_workflow_create_rotate_description' | translate}}"
            >
                <oui-numeric
                    id="rotate"
                    name="rotate"
                    data-model="$ctrl.schedule.rotation"
                    min="1"
                >
                </oui-numeric>
            </oui-field>
            <oui-field
                data-label="{{ ::'pci_workflow_create_execution_count' | translate}}"
                data-help-text="{{ ::'pci_workflow_create_execution_count_description' | translate}}"
            >
                <oui-numeric
                    id="execution-count"
                    name="execution-count"
                    data-model="$ctrl.schedule.maxExecutionCount"
                    min="0"
                >
                </oui-numeric>
            </oui-field>
        </section>
    </div>
</div>
<div class="container-fluid px-0" data-ng-if="!$ctrl.isEditMode">
    <div class="row">
        <oui-select-picker
            class="d-inline-block col-md-6 col-xl-4 my-3"
            data-ng-if="!$ctrl.isEditMode && $ctrl.schedule.cronPattern"
            data-name="{{ $ctrl.schedule.name }}"
            data-model="$ctrl.schedule"
            data-label="{{ ('pci_workflow_create_schedule_' + $ctrl.schedule.name + '_title' | translate) + ' (' + $ctrl.getCronPattern() + ')' }}"
            data-values="[$ctrl.schedule]"
        >
        </oui-select-picker>
    </div>
</div>

<script type="text/ng-template" id="cron-help.html">
    <div><strong>*</strong><span class="pl-3"
        data-translate="pci_workflow_create_cron_wildcard_description"></span></div>
    <div><strong>-</strong><span class="pl-3"
        data-translate="pci_workflow_create_cron_range_description"
        data-translate-values="{ rangeExample: '(0-4,8-12)' }"></span></div>
    <div><strong>/</strong><span class="pl-3"
        data-translate="pci_workflow_create_cron_step_description"
        data-translate-values="{ stepExample: '(23/2)' }"></span></div>
    <div><strong>,</strong><span class="pl-3"
        data-translate="pci_workflow_create_cron_lists_description"
        data-translate-values="{ listExample: '(1,2,5,9)' }"></span></div>
</script>

<script type="text/ng-template" id="cron-month-help.html">
    <ul>
        <li data-translate="pci_workflow_create_cron_month_helper_1"></li>
        <li data-translate="pci_workflow_create_cron_month_helper_2"
            data-translate-values="{ monthNameExample: 'jan, feb, mar, apr, may, jun, jul, aug, sep, oct, nov, or dec' }"></li>
    </ul>
</script>

<script type="text/ng-template" id="cron-dow-help.html">
    <ul>
        <li data-translate="pci_workflow_create_cron_dow_helper_1"></li>
        <li data-translate="pci_workflow_create_cron_dow_helper_2"
            data-translate-values="{ weekNameExample: 'mon, tue, wed, thu, fri, sat, or sun' }"></li>
    </ul>
</script>
